const { Pull, Push, keygen, ABYTES } = require('./')

const key = keygen()

// the sender
const push = new Push(key)

// the receiver
const pull = new Pull(key)

// send header to the other side
pull.init(push.header)

// send the cipher to the other side

const inplaceEnc = Buffer.alloc(4 + ABYTES)
const plain = inplaceEnc.subarray(1, 5)
plain.write('test')

const cipher1 = push.next(plain, inplaceEnc)
console.log(cipher1 === inplaceEnc)

// prints "test"
console.log(pull.next(cipher1, cipher1.subarray(0, 4)))
